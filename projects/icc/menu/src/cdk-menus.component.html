<!-- Use form due to the use checkbox in the menu item -->
<form *ngIf="form" cdkMenu [formGroup]="form">
  <div class="icc-menu-row" *ngFor="let item of items">
    <icc-menu-item
      *ngIf="isLeafMenu(item)"
      iccMenuItem
      [keepOpen]="!!item.keepOpen"
      [disabled]="getDisabled(item)"
      [form]="form"
      [menuItem]="item"
      (iccMenuItemClick)="menuItemClick($event)"
    >
    </icc-menu-item>

    <span *ngIf="hasChildItem(item) && level === 0" iccMenuItem [cdkMenuTriggerFor]="menu">
      <icc-icon *ngIf="item.icon" [config]="item.icon"></icc-icon>
      <span class="icc-menu-item-title"> {{ item.title }}</span>
    </span>

    <icc-menu-item
      *ngIf="hasChildItem(item) && level > 0"
      CdkMenuItemCheckbox
      [cdkMenuTriggerFor]="menu"
      [disabled]="getDisabled(item)"
      [form]="form"
      [menuItem]="item"
      (iccMenuItemClick)="menuItemClick($event)"
    >
    </icc-menu-item>

    <ng-template #menu>
      <cdk-menus
        [form]="form"
        class="icc-menus-sub-level"
        [items]="item.children!"
        [values]="values"
        [disabled]="disabled"
        [level]="level + 1"
        (iccMenuItemClick)="menuItemClick($event)"
      >
      </cdk-menus>
    </ng-template>
  </div>
</form>
